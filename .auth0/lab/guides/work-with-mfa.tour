{
  "$schema": "https://aka.ms/codetour-schema",
  "title": "1: Work with Multifactor Authentication",
  "steps": [
    {
      "file": "README.md",
      "line": 1,
      "title": "What you'll do",
      "description": "**Here's what you'll do:**  \n\n1.  Enable Phone Message factor\n1.  Enforce MFA for all users in your tenant\n1.  Enable Email factor\n1.  Reset MFA for a user\n1.  (Optional) Enable Push factor via Auth0 Guardian\n1.  (Optional) Enable One-time Password factor with Authy app"
    },
    {
      "file": "README.md",
      "line": 1,
      "title": "Enable the Phone Message factor",
      "description": "## Enable Phone Message factor\n\nIf you use SMS as an authentication factor, when an end-user attempts to authenticate with your application, they are sent a code via SMS, which they will have to enter to complete the transaction. This implies that they both know their login credentials and are in possession of the device that they have registered for MFA use.  \n\n1. #### To enable the factors you require, go to _Dashboard > Security > Multi-factor Auth_. '\n    Here you will find a series of the MFA factors supported by Auth0.  \n      \n    ![browse to the multifactor authentication page](https://cdn.auth0.com/website/a0fun/v2/mfa-1.gif)  \n    \n1. #### Select _Phone message_ and toggle the switch to enabled.  \n    Note the exclamation point warning (“!”) at the top of the page.   \n      \n    Your plan includes 100 SMS codes. You can configure an SMS delivery provider to remove this limit, but this isn't necessary for the lab.\n\n    ![enable the phone message factor](https://cdn.auth0.com/website/a0fun/v2/mfa-2.gif)  \n    \n1. #### Scroll down to see the configuration options. \n    First you will find the delivery provider options.\n     \n    * __Auth0__: Sends the messages using Auth0's internally-configured SMS delivery provider. It can be used for evaluation and testing purposes, and there is a maximum of 100 messages per tenant during the entire tenant lifetime. New codes are not received after reaching the 100 message limit.  \n      \n        You can't use this provider to send Voice messages.  \n      \n    * __Twilio__: Sends the messages using the Twilio Programmable SMS API for SMS or Twilio Programmable Voice API for voice. Use Twilio Life  \n    Credentials, not Test Credentials, which are only meant to send messages in a production environment.  \n      \n    * __Custom__: Sends the messages by invoking the Send Phone Message Action.  \n      \n1. #### Now enroll a user for MFA. Go to _Dashboard > User Management > Users_ and click into a user account for which __you can both receive emails and SMS text messages. (One you have access to and have configured phone and email for).__  \n      \n1. #### Then, Open the _Details tab_, locate the Multi-Factor Authentication section, and click the MFA _Send an enrollment invitation link_.\n\n    ![send an enrollment link](https://cdn.auth0.com/website/a0fun/v2/mfa-3.gif)   \n    \n1. #### Verify your phone:    \n    In your email account (One you have accecss to), you will receive an email from your tenant name, with the subject _Invitation to enroll in Multifactor Authentication._ \n    1. #### Open the email and click the _ENROLL IN MULTIFACTOR AUTHENTICATION_ link. The phone number prompt will be displayed.  \n\n    1. #### Enter a phone number you have access to now, that can receive SMS messages. Then click _Continue_ to proceed. \n        The code prompt screen is displayed.  \n        \n    1. #### When you receive the SMS message, enter the code into the prompt, and click _Continue_ to validate. \n        If successful, you'll see the following:\n\n    ![validate](https://cdn.auth0.com/website/a0fun/v2/mfa-4.gif)  \n    \n1. #### Return to the _Details_ view of the user in _Dashboard > User Management > Users_. \n    Note that the Multi-factor Authentication section now shows the user has enrolled with a phone.\n\n    ![view the user's enrollment data](https://cdn.auth0.com/website/a0fun/v2/mfa-5.gif)    \n    \n1. #### Try it out:\n    1. #### Click [here](command:workbench.action.debug.start) to deploy the _Lab: Web App_.\n        Give the app a few moments to deploy. (You can watch the debug terminal to see when it's finished.)  \n\n    1. #### Click [here](command:auth0.lab.openEndpointByName?[\"Lab: Web App, Lab: API\"]) to open the app in your browser and test logging in.\n\n        You may need to log out fully before attempting to log in. To do so, navigate to: https://YOUR-TENANT-DOMAIN.REGION.auth0.com/v2/logout\n    \n        You’ll note that you’re not challenged for a second factor. \n        Although you have enabled the Phone Message factor for the account and enrolled the user’s phone, you have not yet set up your tenant to require its use.  \n\n    ![try it out](https://cdn.auth0.com/website/a0fun/v2/mfa-6.gif)    \n\nLet's fix this by enforcing MFA for all users."
    },
    {
      "file": "README.md",
      "line": 1,
      "title": "Enforce MFA for all users in your tenant",
      "description": "## Enforce MFA for all users in your tenant\n\n1. #### Go to _Security > Multi-factor Auth_. Then, Scroll down the page to the _Define policies_ section.  \n      \n    ![locate the define policies settings](https://cdn.auth0.com/website/a0fun/v2/mfa-7.gif)    \n    \n1. #### In the _Require Multi-factor Auth_ section choose _Always,_ then click _Save_ and _Continue_ to confirm.  \n    \n    ![set require multi-factor auth to always](https://cdn.auth0.com/website/a0fun/v2/mfa-8.gif)    \n    \n1. #### Return to the _Lab: Web App_ and test logging in again, with the same credentials. (You'll need to log out first.)\n      \n    After entering the credentials for the MFA protected user, you are now prompted for the code sent via SMS.  \n      \n1. #### Enter the code you receive on your phone. \n    \n    You’ll see the green checkmark and the “Auth0 has verified your identity” message.\n\n    ![enter the code from your phone](https://cdn.auth0.com/website/a0fun/v2/mfa-9.gif)    \n\nNext, we'll enable the Email factor. "
    },
    {
      "file": "README.md",
      "line": 1,
      "title": "Enable the Email factor",
      "description": "## Enable Email factor\n\nYou can use email to provide users a way to perform MFA when they don't have their phone to receive an SMS or push notification.  \n  \nNote that email is not available as an authentication factor when using the Classic Universal Login experience.  \n\n1. #### Go to _Security > Multi-factor Auth_, and toggle the switch to enable _Email_.\n    ![enable the email factor](https://cdn.auth0.com/website/a0fun/v2/mfa-10.gif)  \n\n1. #### Now, navigate to the Details view for the MFA same MFA user we've been using: _Dashboard > User Management > Users_. Note that the user was automatically enrolled with an Email.  \n      \n    This is because they have previously verified their email address, so no other enrollment activities are required of the user.\n\n    If you do not see the email enrollment, verify the listed email address is marked as verified. You can manually verify the email by clicking the Edit link.    \n\n    ![view the user's enrollment](https://cdn.auth0.com/website/a0fun/v2/mfa-11.gif)  \n      \n1. #### Test the login again in your _Lab: Web App_ (remember to log out first).\n       \n    1. #### On the MFA screen _Do not enter your SMS code_. Instead, locate the _Try another method_ link at the bottom of the dialog and _click_ it. \n        The _Other methods_ dialog is displayed.    \n\n            You will see three options:\n                *   SMS\n                *   Email\n                *   Recovery code  \n            \n    1. #### Click _Email_. \n        The _Verify your Identity_ dialog is displayed, this time with a redacted version of the user’s email address.  \n        \n    1. #### Check your email inbox and you will find an email from your tenant name, with the subject _Your authentication code_. Locate the code in the body of the email and memorize or copy it.  \n        \n    1. #### Back in the browser, enter or paste the code into the code field of the dialog.  \n        \n    1. #### Click _Continue_ to complete authentication.\n\n![log in using email as a second factor](https://cdn.auth0.com/website/a0fun/v2/mfa-12.gif)  \n\nNext, we'll reset MFA for the user."
    },
    {
      "file": "README.md",
      "line": 1,
      "title": "Reset MFA for a user",
      "description": "## Reset MFA for a User\n\nIf a user has lost their mobile device, they can use their recovery code to log in. If they do not have a recovery code, they will need their tenant administrator to reset their multi-factor authentication (MFA).\n\nThis action is equivalent to removing or deleting the user's MFA registration. The MFA settings associated with the user will be removed, which allows them to set up MFA as if they were a new user on their next login attempt.   \n\n1. #### Reset MFA:\n    1. #### Go to the Details view of the MFA user in _Dashboard > User Management > Users_, then select the user.\n    1. #### Locate the Multi-Factor Authentication section, and select the _Reset MFA_ link. \n        The _Reset User MFA_ modal dialog is displayed, with the warning message “Are you really sure you want to reset MFA enrollment for this user? This cannot be undone!”   \n    1. #### Click _YES, RESET IT_. \n        You are returned to the user’s details tab. Note the SMS factor and recovery code are no longer shown.   \n\n    ![reset MFA](https://cdn.auth0.com/website/a0fun/v2/mfa-13.gif)  \n    \n1. #### Test the login in your _Lab: Web App_.  \n    After entering your credentials you will be forced to re-enroll your phone number for the Phone factor.  \n\n    ![test the login](https://cdn.auth0.com/website/a0fun/v2/mfa-14.gif)    \n\nNext, optionally, we'll enable the Push factor."
    },
    {
      "file": "README.md",
      "line": 1,
      "title": "Challenge (optional): Enable the Push factor via Auth0 Guardian",
      "description": "## Challenge (optional): Enable Push factor via Auth0 Guardian\n\n_This optional exercise requires you to install the Auth0 Guardian app on a supported device. If you are unable to install apps on an iOS or Android device, you can skip this exercise._\n\n_As an added challenge, we'll leave out the screenshots -- you should be able to navigate the relevant parts of the dashboard now._\n\nAuth0 Guardian is a mobile app that can deliver push notifications to a user’s pre-registered device - typically a mobile phone or tablet - from which a user can immediately allow or deny account access via the press of a button. It can also generate one-time passwords if that factor is preferred.  \n\n1. #### Install the Auth0 Guardian App if you do not already have it:\n    *   [iOS](https://apps.apple.com/us/app/auth0-guardian/id1093447833)\n    *   [Android](https://play.google.com/store/apps/details?id=com.auth0.guardian)\n\n1. #### Ensure that you have phone, email, and Guardian factors enabled under _Multifactor Auth_ in the Auth0 dashboard. (Enable, set to Always and save)  \n      \n    1. #### Navigate to _Security > Multi-factor Auth_.  \n      \n    1. #### Enable _Push via Auth0 Guardian_. \n        Note you will now have multiple factors enabled: Phone, Email and Push notifications.  \n    \n1. #### Test the MFA enrollment flow when multiple factors are available for the user in your _Lab: Web App_. (Remember to log out first and reset MFA for the user). \n    The _Secure Your Account_ dialog is displayed.  \n    \n1. #### Click the _Try another method_ link at the bottom of the dialog. \n    The _Other methods_ dialog is displayed.   \n    Here you can choose which factor you want to use to secure your account. \n\n1. #### Select _Notification via Auth0 Guardian app_ to return to the previous dialog.  \n    \n1. #### As you have already installed the Guardian app on your device, click _Continue_.  \n    \n1. #### You’ll see a QR code displayed. Open the Guardian app on your device, and tap the _+_ in the top right corner. \n    Note, if this is the first time you’ve used Guardian on your device, you will be prompted to allow the app to use your camera in order to scan the QR code.  \n    \n1. #### Now scan the QR code. \n    The Guardian app will create a new entry with your tenant name and your email address.    \n    \n    In your browser window note the _Almost There!_ dialog is displayed with your recovery code. \n    \n1. #### Copy the recovery code to a secure location, such as a password manager. Check _I have safely recorded this code_ and continue. \n    You’ll be logged into the app.  \n    \n1. #### Go to the Details view of the MFA user in _Dashboard > User Management > Users_. \n    Note that your device is now listed as an MFA factor with the message _Enrolled using Push Notification and TOTP_.  \n    \n1. #### Test the login process using Guardian with your _Lab: Web App_. (Remember to log out first). Enter your credentials. \n    The _Verify Your Identity_ dialog is displayed, with your device name and an _Awaiting confirmation_ message.    \n    On your device, you will receive a push notification message for the Guardian app stating _Authentication Request_. \n\n1. #### Tap the message. \n    The Guardian App will display the Authentication request details, including device, location, and date.      \n    At the bottom of the screen are two buttons: Deny and Allow. \n    \n1. #### Tap _Deny_. \n    A pop-up will offer you two options: _I’ve been hacked_ and _It was a mistake_. \n\n1. #### Tap _Cancel_.\n\n1. #### Now, tap _Allow._ \n    In your browser, your login will continue and you’ll arrive in the app."
    },
    {
      "file": "README.md",
      "line": 1,
      "title": "Challenge (optional): Enable the One-time Password factor",
      "description": "## Challenge (optional): Enable One-time Password factor\n_This optional exercise requires you to use a Time-based One Time Password app on a supported device. If you are unable to install apps on an iOS or Android device, you can skip this exercise._\n\n_As an added challenge, we'll leave out the screenshots -- you should be able to navigate the relevant parts of the dashboard now._  \n\nOne-Time Password (OTP) allows you to use an authenticator application in your personal device, such as Google Authenticator, that will generate a one-time password that changes over time and which can be entered as the second factor to validate a user’s account.  \n  \nUpon signup, you can scan a code and set up the app, upon which it will begin generating one-time codes. Afterward, when logging in to the app, you can simply check the authenticator app for the current one-time code:  \n\n1. #### Install the Google Authenticator App if you do not already have it:\n    *   [iOS](https://itunes.apple.com/us/app/authy/id494168017)\n    *   [Android](https://play.google.com/store/apps/details?id=com.authy.authy)Alternatively, if you have an OTP app already, you can use that for this exercise.  \n          \n        \n1. #### Ensure that you have phone, email, and Guardian factors enabled under _Multifactor Auth_ in the Auth0 dashboard. (Enable, set to Always and save)  \n        \n1. #### Navigate to _Security > Multifactor Auth_.  \n    \n1. #### Enable _One-time Password_.  \n    \n6. #### Go to the Details view of the MFA user in _Dashboard > User Management > Users_ and locate the Multi-factor Authentication section.  \n      \n    \n1. #### Click the _Reset MFA_ link.  \n      \n    \n1. #### Start the MFA enrollment flow with _Getting Started_ _>_ _Try it out_ (remember to log out first). Enter your credentials.    \n    The _Secure Your Account_ dialog is displayed, and prompts you to install the Guardian app if you don’t already have it. \n\n1. #### Click the _Try another method_ link at the bottom of the dialog. \n    The _Other methods_ dialog is displayed.  \n       \n1. #### Choose _Google Authenticator or similar_.  \n    You’ll see a QR code displayed. \n\n1. #### Open Google Authenticator, or the OTP app you currently use and scan the QR code. \n    The OTP app will create a new entry with your tenant name and your email address.   \n    \n1. #### In the OTP app, make a note of the 6 digit security code for your account. \n\n1. #### Then, go to your browser and enter the code in the field, and click _Continue._ \n    The _Almost There!_ dialog is displayed with your recovery code.    \n    \n1. #### Copy the recovery code to a secure location, such as a password manager. \n\n1. #### Check _I have safely recorded this number_ and continue.  \n    You’ll be logged into the app.      \n    \n1. #### Navigate to the Details view of the MFA user in _Dashboard > User Management > Users_. \n    Note that _TOTP (One-time code)_ is now listed as an MFA factor.  \n    \n1. #### Test the login process using Google Authenticator with your _Lab: Web App_ (remember to log out first). Enter your credentials. \n    The _Verify Your Identity_ dialog is displayed, with the message _Check your preferred one-time password application for a code._  \n    \n1. #### On your device, check your OTP app and make a note of the 6 digit security code for your account. \n\n1. #### In your browser, enter the code and click _Continue._ \n    You’ll be logged into the app.\n\nNice work! You've successfully enabled the OTP factor!"
    },
    {
      "file": "README.md",
      "line": 1,
      "title": "Recap",
      "description": "## Recap\n\n**In this lab you:**\n\n*   Enabled the Phone Message factor\n*   Enrolled a phone to receive SMS codes\n*   Enforced MFA for all users in your tenant\n*   Enabled the Email factor\n*   Selected which factor to use during login, if one is not currently available to you\n*   OPTIONAL challenge: Enabled Push factor via Auth0 Guardian\n*   OPTIONAL challenge: Enabled One-time Password factor with Authy app"
    }
  ]
}